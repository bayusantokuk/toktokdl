<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8">
<title>TokTokDL</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{font-family:sans-serif;background:#f7f8fb;color:#333;padding:20px;}
input,button{padding:10px;margin:5px;}
#result{margin-top:20px;display:none;}
#thumb{width:200px;height:150px;background:#eee;margin-bottom:10px;}
</style>
</head>
<body>
<h1>TokTokDL â€” TikTok Downloader</h1>
<input id="urlInput" placeholder="Tempel link TikTok">
<button id="goBtn">Download</button>
<div id="status"></div>
<div id="error" style="color:red;display:none;"></div>

<div id="result">
  <div id="thumb"></div>
  <h3 id="title"></h3>
  <p id="author"></p>
  <a id="dlBtn" href="#" download="tiktok.mp4">Download Video</a>
</div>

<script>
const goBtn = document.getElementById('goBtn');
const urlInput = document.getElementById('urlInput');
const resultEl = document.getElementById('result');
const dlBtn = document.getElementById('dlBtn');
const thumbEl = document.getElementById('thumb');
const titleEl = document.getElementById('title');
const authorEl = document.getElementById('author');
const statusEl = document.getElementById('status');
const errorEl = document.getElementById('error');

goBtn.addEventListener('click', async () => {
  const url = urlInput.value.trim();
  errorEl.style.display = 'none';
  statusEl.textContent = 'Mencari video...';

  try {
    const res = await fetch(`/api/tiktok?url=${encodeURIComponent(url)}`);
    const data = await res.json();

    if (!res.ok) throw new Error(data.error || 'Gagal fetch');

    dlBtn.href = data.videoUrl;
    titleEl.textContent = data.title;
    authorEl.textContent = data.author;
    thumbEl.style.backgroundImage = `url('${data.thumb}')`;
    resultEl.style.display = 'block';
    statusEl.textContent = 'Selesai! Klik Download.';
  } catch (e) {
    errorEl.style.display = 'block';
    errorEl.textContent = e.message;
    statusEl.textContent = '';
  }
});
</script>
</body>
</html>
