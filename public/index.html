<script>
const goBtn = document.getElementById('goBtn');
const urlInput = document.getElementById('urlInput');
const resultEl = document.getElementById('result');
const dlBtn = document.getElementById('dlBtn');
const thumbEl = document.getElementById('thumb');
const titleEl = document.getElementById('title');
const authorEl = document.getElementById('author');
const statusEl = document.getElementById('status');
const errorEl = document.getElementById('error');

goBtn.addEventListener('click', async () => {
  const url = urlInput.value.trim();
  errorEl.style.display = 'none';
  statusEl.textContent = 'Mencari video...';

  try {
    const res = await fetch(`/api/tiktok?url=${encodeURIComponent(url)}`);
    const data = await res.json();

    if (!res.ok) throw new Error(data.error || 'Gagal fetch');

    dlBtn.href = data.videoUrl;
    dlBtn.setAttribute('download', 'tiktok.mp4');
    resultEl.style.display = 'flex';
    statusEl.textContent = 'Selesai! Klik Download.';
  } catch (e) {
    errorEl.style.display = 'block';
    errorEl.textContent = e.message;
    statusEl.textContent = '';
  }
});
</script>
